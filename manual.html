<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Examples" href="examples.html" /><link rel="prev" title="Install" href="installation.html" />

    <meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Manual - sibench 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">sibench 1.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">sibench 1.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">sibench</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Install</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmaster.html">Benchmaster</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="manual">
<h1>Manual<a class="headerlink" href="#manual" title="Permalink to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">sibench</span></code> is a benchmarking tool for storage systems, and for Ceph in particular.</p>
<p><code class="docutils literal notranslate"><span class="pre">sibench</span></code> typically runs on many nodes in parallel, in order to be able to scale
up to the very high bandwidths of which modern scaleable storage systems are
capable.</p>
<p>For more detailed information, visit <a class="reference external" href="https://sibench.io">https://sibench.io</a>.</p>
<section id="how-it-works">
<h2>How It Works<a class="headerlink" href="#how-it-works" title="Permalink to this heading">#</a></h2>
<p>Each benchmarking node runs <code class="docutils literal notranslate"><span class="pre">sibench</span></code> as a server daemon, listening for incoming
connections from a <code class="docutils literal notranslate"><span class="pre">sibench</span></code> client.</p>
<p>Once the client starts a benchmark, the <code class="docutils literal notranslate"><span class="pre">sibench</span></code> servers send periodic summaries
back to it, so that the user can see progress.</p>
<p>When a benchmark completes, the <code class="docutils literal notranslate"><span class="pre">sibench</span></code> servers send the full results back to
the client.  A summary of the results is dislplayed by the client, but the full
results of every individual read and write operation are written out as a json
file in case the user wishes to perform their own statistical analysis.</p>
<p>Once a client starts running a benchmark on some set of <code class="docutils literal notranslate"><span class="pre">sibench</span></code> servers, those
servers will reject any other incoming connections until the benchmark completes
or is aborted.  There is no job queue or long-lived management process.</p>
<p>The client and server use the same binary, just with different command line
options.  The client is extremely lightweight, and may be run on one of the
server nodes without significantly impacting benchmarking performance, though
it may result in higher memory usage on that node.</p>
</section>
<section id="command-line">
<h2>Command Line<a class="headerlink" href="#command-line" title="Permalink to this heading">#</a></h2>
<p>The following is a list of all the commands that the sibench binary accepts:</p>
<dl class="simple">
<dt><strong>sibench -h | --help</strong></dt><dd><p>Outputs the full command line syntax.</p>
</dd>
<dt><strong>sibench version</strong></dt><dd><p>Outputs the version number of the sibench binary.</p>
</dd>
<dt><strong>sibench server</strong> [--verbosity LEVEL] [--port PORT] [--mounts-dir DIR]</dt><dd><p>Starts sibench as a server.</p>
</dd>
<dt><strong>sibench s3 run</strong> [--s3-port PORT] [--s3-bucket BUCKET] (--s3-access-key KEY) (--s3-secret-key KEY) &lt;target&gt; …</dt><dd><p>Starts a benchmark using the S3 object protocol against the specified targets, which may S3 servers or RadosGateway nodes.</p>
</dd>
<dt><strong>sibench rados run</strong> [--ceph-pool POOL] [--ceph-user USER] (--ceph-key KEY) &lt;target&gt; …</dt><dd><p>Starts a benchmark using the Rados object protocol against the specified targets, which should be Ceph monitors.</p>
</dd>
<dt><strong>sibench cephfs run</strong> [--mounts-dir DIR] [--ceph-dir DIR] [--ceph-user USER] (--ceph-key KEY) &lt;target&gt; …</dt><dd><p>Starts a benchmark using CephFS against the specified targets, which should be Ceph monitors.</p>
</dd>
<dt><strong>sibench rbd run</strong> [--ceph-pool POOL] [--ceph-datapool POOL] [--ceph-user USER] (--ceph-key KEY) &lt;target&gt; …</dt><dd><p>Starts a benchmark using RBD against the specified targets, which should be Ceph monitors.</p>
</dd>
<dt><strong>sibench block run</strong> [--block-device DEVICE]</dt><dd><p>Starts a benchmark using a locally mounted block device.</p>
</dd>
<dt><strong>sibench file run</strong> [--file-dir DIR]</dt><dd><p>Starts a benchmark using a locally mounted filesystem.</p>
</dd>
</dl>
<p>Additional options <strong>shared by all run commands</strong>, omitted from above for clarity:</p>
<ul class="simple">
<li><p>[--verbosity LEVEL]</p></li>
<li><p>[--port PORT]</p></li>
<li><p>[--object-size SIZE]</p></li>
<li><p>[--object-count COUNT]</p></li>
<li><p>[--ramp-up TIME]</p></li>
<li><p>[--run-time TIME]</p></li>
<li><p>[--ramp-down TIME]</p></li>
<li><p>[--read-write-mix MIX]</p></li>
<li><p>[--bandwidth BW]</p></li>
<li><p>[--output FILE]</p></li>
<li><p>[--workers FACTOR]</p></li>
<li><p>[--generator GEN]</p></li>
<li><p>[--slice-dir DIR]</p></li>
<li><p>[--slice-count COUNT]</p></li>
<li><p>[--slice-size BYTES]</p></li>
<li><p>[--skip-read-verification]</p></li>
<li><p>[--servers SERVERS]</p></li>
<li><p>[--use-bytes]</p></li>
<li><p>[--individual-stats]</p></li>
</ul>
<section id="option-definitions">
<h3>Option Definitions<a class="headerlink" href="#option-definitions" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Long</p></th>
<th class="head"><p>Short</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>--help</strong></p></td>
<td><p><strong>-h</strong></p></td>
<td><p>-</p></td>
<td><p>Show full usage.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--verbosity</strong></p></td>
<td><p><strong>-v</strong></p></td>
<td><p><em>LEVEL</em></p></td>
<td><p>Set debugging output at level “off”, “debug” or “trace”.  The “trace” level may
generate enough output to affect benchmark performance, and should only be used when
trying to track down issues.</p></td>
<td><p>off</p></td>
</tr>
<tr class="row-even"><td><p><strong>--port</strong></p></td>
<td><p><strong>-p</strong></p></td>
<td><p><em>PORT</em></p></td>
<td><p>The port on which <code class="docutils literal notranslate"><span class="pre">sibench</span></code> communicates.</p></td>
<td><p>5150</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--object-size</strong></p></td>
<td><p><strong>-s</strong></p></td>
<td><p><em>SIZE</em></p></td>
<td><p>Object size to test, in units of K or M.</p></td>
<td><p>1M</p></td>
</tr>
<tr class="row-even"><td><p><strong>--object-count</strong></p></td>
<td><p><strong>-c</strong></p></td>
<td><p><em>COUNT</em></p></td>
<td><p>The total number of objects to use as our working set.</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--ramp-up</strong></p></td>
<td><p><strong>-u</strong></p></td>
<td><p><em>TIME</em></p></td>
<td><p>The number of seconds at the start of each phase where we don’t record data (to
discount edge effects caused by new connections).</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p><strong>--run-time</strong></p></td>
<td><p><strong>-r</strong></p></td>
<td><p><em>TIME</em></p></td>
<td><p>The number of seconds in the middle on each phase of the benchmark where we
do record the data.</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--ramp-down</strong></p></td>
<td><p><strong>-d</strong></p></td>
<td><p><em>TIME</em></p></td>
<td><p>The number of seconds at the end of each phase where we don’t record data.</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><strong>--read-write-mix</strong></p></td>
<td><p><strong>-x</strong></p></td>
<td><p><em>MIX</em></p></td>
<td><p>The ratio between read and writes, specified as the percentage of reads.
A value of zero indicates that reads and writes should be done in separate passes,
rather than being combined.</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--bandwidth</strong></p></td>
<td><p><strong>-b</strong></p></td>
<td><p><em>BW</em></p></td>
<td><p>Benchmark at a fixed bandwidth, in units of K, M or G bits/s
A value of zero indicates no limit.
When the read/write mix is not zero - that is, when we are not doing separate passes
for read and write - then this is the bandwidth of the combined operations.</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p><strong>--output</strong></p></td>
<td><p><strong>-o</strong></p></td>
<td><p><em>FILE</em></p></td>
<td><p>The file to which we write our json results.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>--workers</strong></p></td>
<td><p><strong>-w</strong></p></td>
<td><p><em>FACTOR</em></p></td>
<td><p>Number of worker threads per server as a factor x number of CPU cores.</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p><strong>--mounts-dir</strong></p></td>
<td><p><strong>-m</strong></p></td>
<td><p><em>DIR</em></p></td>
<td><p>The directory in which we should create any filesystem mounts that are performed by
<code class="docutils literal notranslate"><span class="pre">sibench</span></code> itself, such as when using CephFS.  It is not needed for running generic
filesystem benchmarks, because those must be mounted outside of <code class="docutils literal notranslate"><span class="pre">sibench</span></code>.</p></td>
<td><p>/tmp/sibench_mnt</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--generator</strong></p></td>
<td><p><strong>-g</strong></p></td>
<td><p><em>GEN</em></p></td>
<td><p>Which object generator to use: “prng” or “slice”.</p></td>
<td><p>prng</p></td>
</tr>
<tr class="row-even"><td><p><strong>--skip-read-verification</strong></p></td>
<td></td>
<td><p>-</p></td>
<td><p>Disable validation on reads.  This should only be used to check if the number of nodes
in the <code class="docutils literal notranslate"><span class="pre">sibench</span></code> cluster is a limiting factor when benchmarking read performance.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--servers</strong></p></td>
<td></td>
<td><p><em>SERVERS</em></p></td>
<td><p>A comma-separated list of <code class="docutils literal notranslate"><span class="pre">sibench</span></code> servers to connect to.</p></td>
<td><p>localhost</p></td>
</tr>
<tr class="row-even"><td><p><strong>--s3-port</strong></p></td>
<td></td>
<td><p><em>PORT</em></p></td>
<td><p>The port on which to connect to S3.</p></td>
<td><p>7480</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--s3-bucket</strong></p></td>
<td></td>
<td><p><em>BUCKET</em></p></td>
<td><p>The name of the bucket we wish to use for S3 operations.</p></td>
<td><p>sibench</p></td>
</tr>
<tr class="row-even"><td><p><strong>--s3-access-key</strong></p></td>
<td></td>
<td><p><em>KEY</em></p></td>
<td><p>S3 access key.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--s3-secret-key</strong></p></td>
<td></td>
<td><p><em>KEY</em></p></td>
<td><p>S3 secret key.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><strong>--ceph-pool</strong></p></td>
<td></td>
<td><p><em>POOL</em></p></td>
<td><p>The pool we use for benchmarking.</p></td>
<td><p>sibench</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--ceph-datapool</strong></p></td>
<td></td>
<td><p><em>POOL</em></p></td>
<td><p>Optional pool used for RBD.  If set, ceph-pool is used only for metadata.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><strong>--ceph-user</strong></p></td>
<td></td>
<td><p><em>USER</em></p></td>
<td><p>The Ceph username we wish to use.</p></td>
<td><p>admin</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--ceph-key</strong></p></td>
<td></td>
<td><p><em>KEY</em></p></td>
<td><p>The CephX secret key belonging to the ceph user.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><strong>--ceph-dir</strong></p></td>
<td></td>
<td><p><em>DIR</em></p></td>
<td><p>The directory within CephFS that we should use for a benchmark.    This will be created
by <code class="docutils literal notranslate"><span class="pre">sibench</span></code> if it does not already exist.</p></td>
<td><p>sibench</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--block-device</strong></p></td>
<td></td>
<td><p><em>DEVICE</em></p></td>
<td><p>The local block device to use for a benchmark.</p></td>
<td><p>/tmp/sibench_block</p></td>
</tr>
<tr class="row-even"><td><p><strong>--file-dir</strong></p></td>
<td></td>
<td><p><em>DIR</em></p></td>
<td><p>The local directory to use for file operations.  The directory must already exist.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--slice-dir</strong></p></td>
<td></td>
<td><p><em>DIR</em></p></td>
<td><p>The directory of files to be sliced up to form new workload objects.</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><strong>--slice-count</strong></p></td>
<td></td>
<td><p><em>COUNT</em></p></td>
<td><p>The number of slices to construct for workload generation.</p></td>
<td><p>10000</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--slice-size</strong></p></td>
<td></td>
<td><p><em>BYTES</em></p></td>
<td><p>The size of each slice in bytes.</p></td>
<td><p>4096</p></td>
</tr>
<tr class="row-even"><td><p><strong>--use-bytes</strong></p></td>
<td></td>
<td><p>-</p></td>
<td><p>Show bandwidth in Bytes</p></td>
<td><p>off</p></td>
</tr>
<tr class="row-odd"><td><p><strong>--individual-stats</strong></p></td>
<td></td>
<td><p>-</p></td>
<td><p>Record the individual stats in the output file.  This may be VERY big</p></td>
<td><p>off</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="targets">
<h3>Targets<a class="headerlink" href="#targets" title="Permalink to this heading">#</a></h3>
<p>The targets are the nodes to which the worker threads connect.  Each worker
opens a connection to each target and round-robins their reads and writes across
those connections.</p>
<p>For most Ceph operations, the targets are monitors, and there is no advantage to
specifying more than one.  All the monitors do is provide the
state-of-the-cluster map so that the workers can connect to the OSDs directly.</p>
<p>For RGW/S3, however, you should <em>definitely</em> list all of the storage cluster’s
RGW nodes as targets, since those nodes are doing real work, and it needs to be
balanced.</p>
</section>
<section id="rbd">
<h3>RBD<a class="headerlink" href="#rbd" title="Permalink to this heading">#</a></h3>
<p>RBD behaviour is a little different than you might expect: each worker creates
an RBD image per target, just big enough to hold that worker’s share of the
‘objects’ for the benchmark.  All reads and writes that the worker then does are
within the RBD image.</p>
<p>For example, if you have the following:</p>
<ol class="arabic simple">
<li><p>10 <code class="docutils literal notranslate"><span class="pre">sibench</span></code> nodes, each with 16 cores</p></li>
<li><p>A single target monitor</p></li>
<li><p>And object count of 1600 and an object size of 1MB</p></li>
</ol>
<p>Then <code class="docutils literal notranslate"><span class="pre">sibench</span></code> will create 160 workers (by default, it is one per core), each of
which will create a single 10MB RBD image, and then it will proceed to read and
write 1 MB at a time to parts of that image.</p>
</section>
<section id="generators">
<h3>Generators<a class="headerlink" href="#generators" title="Permalink to this heading">#</a></h3>
<p>Generators create the data that <code class="docutils literal notranslate"><span class="pre">sibench</span></code> uses as workloads for the storage
system.  There are currently two of them, selectable with the <code class="docutils literal notranslate"><span class="pre">--generator</span></code>
option.</p>
<section id="prng-generator">
<h4>PRNG Generator<a class="headerlink" href="#prng-generator" title="Permalink to this heading">#</a></h4>
<p>The PRNG generator creates data which is entirely pseudorandom.  It requires no
configuration, and is the default choice.  However, it has one shortcoming:
because it creates pseudorandom data, it is not compressible.  If you wish to
test compression in your storage system, then you will need need to create a
compressible workload.  The same restriction applies to de-duplication
technologies.</p>
</section>
<section id="slice-generator">
<h4>Slice Generator<a class="headerlink" href="#slice-generator" title="Permalink to this heading">#</a></h4>
<p>The Slice generator builds workloads from existing files.  It aims to reproduce
the compressibility characteristics of those files, whilst still creating an
effectively infinite supply of different objects.</p>
<p>It works by taking a directory of files (which will usually be of the same type:
source code, VM images, movies, or whatever), and then loading fixed sized
slices of bytes from random positions within those files.  The end result is
that we have a library of (say) 1000 slices, each containing (say) 4Kb of data.
Both of those values may be set with command line options.</p>
<p>When asked to generate a new workload object the slice generator does the
following:</p>
<ol class="arabic simple">
<li><p>Creates a random seed.</p></li>
<li><p>Writes the seed into the start of the workload object.</p></li>
<li><p>Uses the seed to create a random number generator  just for this workload object.</p></li>
<li><p>Uses that random number generator  to select slices from our library, which are concatenated
onto the object until we have as many bytes as we were asked for.</p></li>
</ol>
<p>This approach means that we do not need to ever store the objects themselves: we
can verify a read operation by reading the seed from the first few bytes, and
then recreating the object we would expect.</p>
<p>Note that the directory of data to be sliced needs to be in the same location on
each of the <code class="docutils literal notranslate"><span class="pre">sibench</span></code> server nodes.</p>
<p>The drivers do <em>not</em> need to have the same files in their slice directories,
though it’s likely that they will.  One option would be to mount the same NFS
share on all the drivers as a repository for the slice data.  Performance when
loading the slices is not a consideration, since it is done before the benchmark
begins, and so will not affect the numbers.</p>
</section>
</section>
<section id="write-cycles">
<h3>Write Cycles<a class="headerlink" href="#write-cycles" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">count</span></code> parameter determines how many objects we create.  However, for long
benchmarks runs, or for small counts or object sizes, we are likely to wrap
around and start writing from the first object again.  If this happens, <code class="docutils literal notranslate"><span class="pre">sibench</span></code>
internally increments a cycle counter, which it uses to ensure that objects
written in different cycles will have different contents, even though the object
will still use the same key as previously.</p>
</section>
<section id="the-prepare-phase">
<h3>The Prepare Phase<a class="headerlink" href="#the-prepare-phase" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sibench</span></code> either benchmarks write operations first and then read operations, or
else it benchmarks a mixture of the too (depending on the <code class="docutils literal notranslate"><span class="pre">--read-write-mix</span></code>
option.  When benchmarking reads, or a read-write mix, it must first ensure that
there are enough objects there to read before it can start work.  This is the
<em>prepare</em> phase, and that is what is happening when you see messages about
‘Preparing’.</p>
<p>It also happens if we are doing separate writes and reads and we did not have a
long enough run time for <code class="docutils literal notranslate"><span class="pre">sibench</span></code> to write all of the objects specified by the
<code class="docutils literal notranslate"><span class="pre">object-count</span></code> option.  In this case, the prepare phase will keep writing until
all the objects are ready for reading.</p>
</section>
<section id="slow-shutdown">
<h3>Slow Shutdown<a class="headerlink" href="#slow-shutdown" title="Permalink to this heading">#</a></h3>
<p>There are times when <code class="docutils literal notranslate"><span class="pre">sibench</span></code> can take a long time when cleaning up after a
benchmark run.  This is due to Ceph being extremely slow at deleting objects.</p>
<p>Future versions of <code class="docutils literal notranslate"><span class="pre">sibench</span></code> may add an option to not clean up their data in order
to avoid this.  (For test clusters with no production data, it would be faster
to not have <code class="docutils literal notranslate"><span class="pre">sibench</span></code> clean up, but to delete and recreate the Ceph pools
instead).</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Examples</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Install</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, SoftIron
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Manual</a><ul>
<li><a class="reference internal" href="#how-it-works">How It Works</a></li>
<li><a class="reference internal" href="#command-line">Command Line</a><ul>
<li><a class="reference internal" href="#option-definitions">Option Definitions</a></li>
<li><a class="reference internal" href="#targets">Targets</a></li>
<li><a class="reference internal" href="#rbd">RBD</a></li>
<li><a class="reference internal" href="#generators">Generators</a><ul>
<li><a class="reference internal" href="#prng-generator">PRNG Generator</a></li>
<li><a class="reference internal" href="#slice-generator">Slice Generator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#write-cycles">Write Cycles</a></li>
<li><a class="reference internal" href="#the-prepare-phase">The Prepare Phase</a></li>
<li><a class="reference internal" href="#slow-shutdown">Slow Shutdown</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>